import java.rmi.RemoteException;
import java.rmi.server.UnicastRemoteObject;
import java.util.HashMap;
import java.util.LinkedList;
import java.util.Map;
import java.util.Queue;

public class BSSManagerImpl extends UnicastRemoteObject implements BSSManager {
    private Queue<String> messageQueue;
    private Map<Integer, int[]> vectorClocks;

    public BSSManagerImpl() throws RemoteException {
        messageQueue = new LinkedList<>();
        vectorClocks = new HashMap<>();
    }

    @Override
    public void sendMessage(int processId, String message, int[] vectorClock) throws RemoteException {
        System.out.println("BSS Manager received message from process " + processId);
        vectorClocks.put(processId, vectorClock);
        messageQueue.add("Message from process " + processId + ": " + message);
        deliverMessages();
    }

    private void deliverMessages() {
        while (!messageQueue.isEmpty()) {
            System.out.println(messageQueue.poll());
        }
    }
}
